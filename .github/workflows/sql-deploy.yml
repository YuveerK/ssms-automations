name: SSMS Database Automation
"on":
  push:
    paths:
      - DatabaseAdministration/SQLStatements/**.sql
    branches:
      - main
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      - name: Install SQLCMD Tools
  run: "curl https://packages.microsoft.com/keys/microsoft.asc | sudo apt-key add -\nsudo add-apt-repository \"$(curl https://packages.microsoft.com/config/ubuntu/20.04/prod.list)\"\nsudo apt-get update\nsudo ACCEPT_EULA=Y apt-get install -y mssql-tools unixodbc-dev\necho 'export PATH=\"$PATH:/opt/mssql-tools/bin\"' >> ~/.bashrc\nsource ~/.bashrc\n\n\n  - name: Execute SQL Scripts on Remote SQL Server\n    run: |\n      for file in DatabaseAdministration/SQLStatements/*.sql\n      do\n        echo \"\U0001F680 Executing $file\"\n        /opt/mssql-tools/bin/sqlcmd \\\n          -S \"${{ secrets.DB_SERVER }}\" \\\n          -U \"${{ secrets.DB_USER }}\" \\\n          -P \"${{ secrets.DB_PASS }}\" \\\n          -d \"${{ secrets.DB_NAME }}\" \\\n          -i \"$file\"\n      done\n    shell: bash\n"
